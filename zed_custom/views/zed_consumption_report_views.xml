<odoo>
  <!-- LIST view -->
  <record id="view_zed_consumption_report_list" model="ir.ui.view">
    <field name="name">zed.consumption.report.list</field>
    <field name="model">zed.consumption.report</field>
    <field name="arch" type="xml">
      <list string="Báo cáo tiêu hao nguyên liệu" create="false" edit="false" delete="false">
        <field name="date"/>
        <field name="picking_id"/>
        <field name="pos_order_id"/>
        <field name="barista_id"/>
        <field name="product_id"/>
        <field name="qty" sum="Tổng số lượng"/>
        <field name="uom_id"/>
        <field name="company_id" groups="base.group_multi_company"/>
      </list>
    </field>
  </record>

  <!-- PIVOT view -->
  <record id="view_zed_consumption_report_pivot" model="ir.ui.view">
    <field name="name">zed.consumption.report.pivot</field>
    <field name="model">zed.consumption.report</field>
    <field name="arch" type="xml">
      <pivot string="Tiêu hao - Pivot">
        <field name="qty" type="measure"/>
        <field name="date" type="col" interval="month"/>
        <field name="product_id" type="row"/>
        <field name="barista_id" type="row"/>
        <field name="pos_order_id" type="row"/>
        <field name="company_id" type="row" groups="base.group_multi_company"/>
      </pivot>
    </field>
  </record>

  <!-- GRAPH view -->
  <record id="view_zed_consumption_report_graph" model="ir.ui.view">
    <field name="name">zed.consumption.report.graph</field>
    <field name="model">zed.consumption.report</field>
    <field name="arch" type="xml">
      <graph string="Tiêu hao - Biểu đồ" type="bar">
        <field name="qty" type="measure"/>
        <field name="date" type="col" interval="day"/>
        <field name="product_id" type="row"/>
      </graph>
    </field>
  </record>

  <!-- SEARCH view -->
  <record id="view_zed_consumption_report_search" model="ir.ui.view">
    <field name="name">zed.consumption.report.search</field>
    <field name="model">zed.consumption.report</field>
    <field name="arch" type="xml">
      <search string="Tìm kiếm tiêu hao">
        <field name="product_id"/>
        <field name="barista_id"/>
        <field name="pos_order_id"/>
        <field name="picking_id"/>
        <field name="company_id" groups="base.group_multi_company"/>
        <filter name="grp_date" string="Theo ngày" context="{'group_by': 'date'}"/>
        <filter name="grp_product" string="Theo sản phẩm" context="{'group_by': 'product_id'}"/>
        <separator/>
        <filter name="last_7d" string="7 ngày" domain="[('date','>=',(context_today()-relativedelta(days=7)).strftime('%%Y-%%m-%%d 00:00:00'))]"/>
        <filter name="this_month" string="Tháng này" domain="[('date','>=',context_today().replace(day=1).strftime('%%Y-%%m-%%d 00:00:00'))]"/>
      </search>
    </field>
  </record>

  <!-- ACTION + MENU -->
  <record id="action_zed_consumption_report" model="ir.actions.act_window">
    <field name="name">Báo cáo tiêu hao</field>
    <field name="res_model">zed.consumption.report</field>
    <field name="view_mode">list,graph,pivot</field>
    <field name="search_view_id" ref="view_zed_consumption_report_search"/>
    <field name="help" type="html">
      <p class="o_view_nocontent_smiling_face">Chưa có dữ liệu tiêu hao.</p>
      <p>Tạo phiếu tiêu hao (zed_move_type = 'consume') và hoàn tất (Done) để thấy số liệu.</p>
    </field>
  </record>

  <menuitem id="menu_zed_consumption_report"
            name="Báo cáo tiêu hao"
            parent="menu_zed_root"
            action="action_zed_consumption_report"
            sequence="60"/>
</odoo>
